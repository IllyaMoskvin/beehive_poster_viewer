# Let people access eg '/posterViewer/?poster=mr', as a shortcut skipping
# the 'viewer.html' in /posterViewer/viewer.html?poster=mr
# because we've said viewer.html is a default document.

DirectoryIndex viewer.html index.html


# Turn on SSI, that viewer.html uses for including partial html
# doc with facebook opengraph tags suitable for the poster

<Files viewer.html>
  Options +Includes
  SetOutputFilter INCLUDES
</Files>

############################
#
# CACHING

# Default mayfirst.org apache conf was leading to files being cached by browsers
# for long time. Not sure how long. We want to control cache headers ourself. 

# For source code, don't cache very long
<FilesMatch "\.(html|xml|js|css)$">
  # Remove the Last-Modified header set by default conf,
  # it resulted in weird things.
  Header unset Last-Modified

  # Make sure etag is there though (was already, but making sure), for conditional
  # GETs
  FileETag All

  # But do give hours of strict cacheability for performance.
  ExpiresActive On
  ExpiresDefault "access plus 2 hours"
</FilesMatch>

# For fonts, cache indefinitely
<FilesMatch "\.(woff|eot|ttf|svg)$">
  ExpiresActive On
  ExpiresDefault "access plus 1 year"
</FilesMatch>


# Openseadragon.js is placed by us in a URL with OpenSeadragon version in it,
# so we can have it cached forever.
<FilesMatch "^openseadragon(\.min)?\.js$">
  ExpiresActive On
  ExpiresDefault "access plus 1 year"
</FilesMatch>

# For jpg's, including the tile source (!), we use default apache for now,
# which seems to result in cacheability.